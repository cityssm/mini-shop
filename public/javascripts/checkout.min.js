"use strict";var __awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))(function(s,r){function n(e){try{c(a.next(e))}catch(e){r(e)}}function i(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(n,i)}c((a=a.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{let e={};const t=document.getElementById("card--cart"),o=document.getElementById("container--cartTotal");let a={itemTotal:0,feeTotals:{}};const s=t=>{t.preventDefault();const o=parseInt(t.currentTarget.getAttribute("data-cart-index")),a=exports.cart.get()[o],s=e.products[a.productSKU];cityssm.confirmModal('Remove "'+s.productName+'"?',"Are you sure you want to remove this item from your cart?","Yes, Remove It","warning",()=>{exports.cart.remove(o),n()})},r=(o,r)=>{const n=e.products[o.productSKU];n||(exports.cart.clear(),location.reload());const i=document.createElement("li");if(i.className="card-content",i.innerHTML='<div class="columns"><div class="column is-narrow has-text-right"><button class="button is-inverted is-danger has-tooltip-arrow has-tooltip-right has-tooltip-hidden-mobile" data-cart-index="'+r.toString()+'" data-tooltip="Remove from Cart" type="button"><i class="fas fa-times" aria-hidden="true"></i><span class="is-hidden-tablet ml-2">Remove from Cart</span></button></div><div class="column"><strong class="container--productName"></strong><br /><div class="is-size-7 container--formFields"></div></div><div class="column is-narrow column--price has-text-weight-bold has-text-right"></div></div>',i.getElementsByTagName("button")[0].addEventListener("click",s),i.getElementsByClassName("container--productName")[0].innerText=n.productName,n.formFieldsToSave&&n.formFieldsToSave.length>0){const e=i.getElementsByClassName("container--formFields")[0];for(const t of n.formFieldsToSave)if(o[t.formFieldName]){e.insertAdjacentHTML("beforeend","<strong>"+t.fieldName+":</strong> ");const a=document.createElement("span");a.innerText=o[t.formFieldName],e.appendChild(a),e.insertAdjacentHTML("beforeend","<br />")}}if(i.getElementsByClassName("column--price")[0].innerText="$"+n.price.toFixed(2),t.appendChild(i),a.itemTotal+=n.price,n.feeTotals&&Object.keys(n.feeTotals).length>0)for(const e of Object.keys(n.feeTotals))a.feeTotals[e]=(a.feeTotals[e]||0)+n.feeTotals[e]},n=()=>{cityssm.clearElement(t),cityssm.clearElement(o),a={itemTotal:0,feeTotals:{}};const s=exports.cart.get();0===s.length?(t.classList.add("is-hidden"),t.insertAdjacentHTML("beforebegin",'<div class="message is-info"><div class="message-body has-text-centered"><p class="has-text-weight-bold">The cart is empty.</p><p><a href="/products">View Available Products</a></p></div></div>')):(s.forEach(r),t.classList.remove("is-hidden"));let n=a.itemTotal;if(Object.keys(a.feeTotals).length>0){o.insertAdjacentHTML("beforeend",'<div class="has-text-weight-bold">Subtotal: $'+a.itemTotal.toFixed(2)+"</div>");for(const t of Object.keys(a.feeTotals))o.insertAdjacentHTML("beforeend","<div>"+e.fees[t].feeName+": $"+a.feeTotals[t].toFixed(2)+"</div>"),n+=a.feeTotals[t]}o.insertAdjacentHTML("beforeend",'<div class="is-size-4 has-text-weight-bold">Total: $'+n.toFixed(2)+"</div>")};(()=>{const t=(()=>{const e=new Set,t=exports.cart.get();for(const o of t)e.add(o.productSKU);return Array.from(e)})().join(",");""!==t?fetch("/checkout/doGetProductDetails",{method:"POST",body:new URLSearchParams({productSKUs:t})}).then(e=>__awaiter(void 0,void 0,void 0,function*(){return yield e.json()})).then(t=>{e=t,n()}).catch(()=>{}):n()})(),document.getElementById("button--clearCart").addEventListener("click",()=>{cityssm.confirmModal("Clear Cart?","Are you sure you want to remove all items from your cart?","Yes, Clear the Cart","warning",()=>{exports.cart.clear(),n()})}),window.setTimeout(()=>{exports.cart.refresh()},3e5)})();